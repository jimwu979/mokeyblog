"use strict";!function(){var b=[];function g(t){return t.height()+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))+parseInt(t.css("border-top-width"))+parseInt(t.css("border-bottom-width"))}function a(){for(var t=$(".COMPONENT_elementbox"),e=t.children(".element"),n=e.length,i=0,o=768<=b.winW?15:7,a=0;a<n;a++)i+=g(e.eq(a))+o;t.height(i)}function s(){for(var t=$(".COMPONENT_elementbox .element"),e=t.length,n=768<=b.winW?15:7,i=n,o=0;o<e;o++){var a=t.eq(o);0<o&&(i+=g(t.eq(o-1))+n),a.css("top",i)}}function t(){b.winW=b.win.width(),b.winH=b.win.height(),a(),s()}b.window=$(window),b.win=$("#fixbox"),b.winW=b.win.width(),b.winH=b.win.height(),$(".COMPONENT_elementbox").on("click",".btn_box .delete",function(){$(this).parents(".element").remove(),a(),s()}).on("click",".btn_box .up, .btn_box .down",function(){var t=$(this),e=1<t.index()?1:-1,n=t.parents(".element"),i=t.parents(".COMPONENT_elementbox");i.css("pointer-events","none");var o=n.index()+e,a=t.parents(".COMPONENT_elementbox").children(".element").eq(o),s=0<e?n:a,l=0<e?a:n,r=parseInt(s.css("top")),c=g(l),d=l.html();l.css("top",r);var p=768<=b.winW?15:7;s.css("top",r+c+p),setTimeout(function(){s.before('<div class="element" style="top: '+r+'px">'+d+"</div>"),l.remove(),i.css("pointer-events","")},200)}).on("click",".COMPONENT_inputbox_dropdown",function(){$(this).toggleClass("open")}).on("click",".COMPONENT_inputbox_dropdown li",function(){var t=$(this),e=t.attr("data-type"),n=t.text();t.parent().siblings().attr("data-type",e).text(n)}).on("click",".element .add",function(){var t,e=$(this),n={title:{label:"標題",content:'<div class="COMPONENT_inputbox_text">\n                                    <input type="text">\n                                </div>'},paragraphy:{label:"段落",content:'<textarea class="COMPONENT_inputbox_textarea"></textarea>'},image:{label:"圖片",content:'<div class="COMPONENT_inputbox_image">\n                                    <input type="file" id="img_">\n                                    <label for="upload_img"></label>\n                                </div>'}},i=e.parent().siblings(".content").children().children("div").attr("data-type"),o="";"image"==i&&(o=(t=new Date).getFullYear().toString()+t.getMonth().toString()+t.getDate().toString()+t.getHours().toString()+t.getMinutes().toString()+t.getSeconds().toString()),e.parents(".element").before('\n                <div class="element" data-type='+i+">\n                    <label>"+n[i].label+'</label>\n                    <div class="content">'+n[i].content+'</div>\n                    <div class="btn_box">\n                        <div class="delete"></div>\n                        <div class="up"></div>\n                        <div class="down"></div>\n                    </div>\n                </div>\n            ').prev(".element").find(".COMPONENT_inputbox_image input").attr("id","img_"+o).siblings("label").attr("for","img_"+o),a(),s()}),$(".COMPONENT_inputbox_text input").on({focus:function(){$(this).parent().addClass("focus")},blur:function(){$(this).parent().removeClass("focus")}}),$(".body").on("change",".COMPONENT_inputbox_image input",function(){var e=$(this),t=new FileReader;t.readAsDataURL(e[0].files[0]),t.onload=function(t){e.parent().css("background-image","url("+t.target.result+")")}}),$(".COMPONENT_inputbox_radio label").click(function(){$(this).addClass("check").parent().siblings(".COMPONENT_inputbox_radio").children("label").removeClass("check")}),$(".COMPONENT_togglebtn").click(function(){$(this).toggleClass("open")}),$(".COMPONENT_message .COMPONENT_togglebtn").click(function(){var t=$(this);t.hasClass("open")?t.parent().removeClass("off"):t.parent().addClass("off")}),t(),$(window).resize(t),$("header .menu_btn").click(function(){$(this).parent().toggleClass("open")}),$(".main_btn .save").click(function(){for(var t=$(".COMPONENT_elementbox").children(".element"),e=t.length,n=0;n<e;n++){var i=t.eq(n),o=i.attr("data-type");"title"==o?i.find(".content input").val():"paragraphy"==o?i.find(".content textarea").val():"image"==o&&i.find(".COMPONENT_inputbox_image").css("background-image")}event.stopPropagation()}),$("html head").prepend("<style>.t{box-shadow: 0 0 3px #F22 inset;animation: test .2s 0s infinite alternate-reverse forwards;}@keyframes test{to{box-shadow: 0 0 2px #22F inset;}}</style>"),localStorage.scrollTop&&$(".body").scrollTop(localStorage.scrollTop),$(".body").on("scroll",function(){localStorage.setItem("scrollTop",$(".body").scrollTop())})}();