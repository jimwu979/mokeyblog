"use strict";!function(){var b=[];function v(t){return t.height()+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))+parseInt(t.css("border-top-width"))+parseInt(t.css("border-bottom-width"))}function o(){for(var t=$(".COMPONENT_elementbox"),e=t.children(".element"),n=e.length,a=0,i=768<=b.winW?15:7,o=0;o<n;o++)a+=v(e.eq(o))+i;t.height(a)}function l(){for(var t=$(".COMPONENT_elementbox .element"),e=t.length,n=768<=b.winW?15:7,a=n,i=0;i<e;i++){var o=t.eq(i);0<i&&(a+=v(t.eq(i-1))+n),o.css("top",a)}}function t(){b.winW=b.win.width(),b.winH=b.win.height(),o(),l()}b.window=$(window),b.win=$("#fixbox"),b.winW=b.win.width(),b.winH=b.win.height(),$(".COMPONENT_elementbox").on("click",".btn_box .delete",function(){$(this).parents(".element").remove(),o(),l()}).on("click",".btn_box .up, .btn_box .down",function(){var t=$(this),e=1<t.index()?1:-1,n=t.parents(".element"),a=t.parents(".COMPONENT_elementbox");a.css("pointer-events","none");var i,o=n.index()+e,l=t.parents(".COMPONENT_elementbox").children(".element").eq(o),s=0<e?n:l,c=0<e?l:n,r=parseInt(s.css("top")),d=v(c),p=c.html(),g=c.attr("data-type");switch(g){case"title":i={htmlTag:"input",value:c.find("input").val()};break;case"paragraphy":i={htmlTag:"textarea",value:c.find("textarea").val()};break;case"image":i={htmlTag:"input",value:c.find("input").val()};break;case"member":i={htmlTag:"input",value:0}}c.css("top",r);var u=768<=b.winW?15:7;s.css("top",r+d+u),setTimeout(function(){s.before('<div   class="element" \n                            style="top: '.concat(r,'px"\n                            data-type="').concat(g,'"\n                    >\n                        ').concat(p,"\n                    </div>"));var t=s.prev();"image"==t.attr("data-type")?t.find(i.htmlTag).value=i.value:"addElement"==t.attr("data-type")&&t.find(i.htmlTag).val(i.value),c.remove(),a.css("pointer-events","")},200)}).on("click",".COMPONENT_inputbox_dropdown",function(){$(this).toggleClass("open")}).on("click",".COMPONENT_inputbox_dropdown li",function(){var t=$(this),e=t.attr("data-type"),n=t.text();t.parent().siblings().attr("data-type",e).text(n)}).on("click",".element .add",function(){var t,e=$(this),n={title:{label:"標題",content:'<div class="COMPONENT_inputbox_text">\n                                    <input type="text">\n                                </div>'},paragraphy:{label:"段落",content:'<textarea class="COMPONENT_inputbox_textarea"></textarea>'},image:{label:"圖片",content:'<div class="COMPONENT_inputbox_image">\n                                    <input type="file" id="img_">\n                                    <label for="upload_img"></label>\n                                </div>'},member:{label:"成員",content:'<div class="img">\n                                    <div class="COMPONENT_inputbox_image">\n                                        <input type="file" id="upload_img" accept="image/jpeg, image/png">\n                                        <label for="upload_img"></label>\n                                    </div>\n                                </div>\n                                <div class="text">\n                                    <div class="COMPONENT_inputbox_text">\n                                        <input type="text" placeholder="姓名">\n                                    </div>\n                                    <div class="COMPONENT_inputbox_text">\n                                        <input type="text" placeholder="職位">\n                                    </div>\n                                </div>'}},a=e.parent().siblings(".content").children().children("div").attr("data-type"),i="";"image"==a&&(i=(t=new Date).getFullYear().toString()+t.getMonth().toString()+t.getDate().toString()+t.getHours().toString()+t.getMinutes().toString()+t.getSeconds().toString()),e.parents(".element").before('\n                <div class="element" data-type='.concat(a,">\n                    <label>\n                        ").concat(n[a].label,'\n                    </label>\n                    <div class="content">\n                        ').concat(n[a].content,'\n                    </div>\n                    <div class="btn_box">\n                        <div class="delete"></div>\n                        <div class="up"></div>\n                        <div class="down"></div>\n                    </div>\n                </div>\n            ')).prev(".element").find(".COMPONENT_inputbox_image input").attr("id","img_"+i).siblings("label").attr("for","img_"+i),o(),l()}),$(".COMPONENT_inputbox_text input").on({focus:function(){$(this).parent().addClass("focus")},blur:function(){$(this).parent().removeClass("focus")}}),$(".body").on("change",".COMPONENT_inputbox_image input",function(){var e=$(this),t=new FileReader;t.readAsDataURL(e[0].files[0]),t.onload=function(t){e.parent().css("background-image","url(".concat(t.target.result,")"))}}),$(".COMPONENT_inputbox_radio label").click(function(){$(this).addClass("check").parent().siblings(".COMPONENT_inputbox_radio").children("label").removeClass("check")}),$(".COMPONENT_togglebtn").click(function(){$(this).toggleClass("open")}),$(".COMPONENT_message .COMPONENT_togglebtn").click(function(){var t=$(this);t.hasClass("open")?t.parent().removeClass("off"):t.parent().addClass("off")}),t(),$(window).resize(t),$("header .menu_btn").click(function(){$(this).parent().toggleClass("open")}),$(".main_btn .save").click(function(){for(var t=$(".COMPONENT_elementbox").children(".element"),e=t.length,n=0;n<e;n++){var a,i=t.eq(n),o=i.attr("data-type");"title"==o?"<h3>\n                            ".concat(i.find(".content input").val(),"\n                        </h3>"):"paragraphy"==o?"<p>\n                            ".concat(i.find(".content textarea").val(),"\n                        </p>"):"image"==o&&(a=i.find(".COMPONENT_inputbox_image").css("background-image"),"<img src='".concat(a,"'>"))}event.stopPropagation()}),$("html head").prepend("<style>.t{box-shadow: 0 0 3px #F22 inset;animation: test .2s 0s infinite alternate-reverse forwards;}@keyframes test{to{box-shadow: 0 0 2px #22F inset;}}</style>"),localStorage.scrollTop&&$(".body").scrollTop(localStorage.scrollTop),$(".body").on("scroll",function(){localStorage.setItem("scrollTop",$(".body").scrollTop())})}();